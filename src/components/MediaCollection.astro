---
interface IProps {
  stacked?: boolean
}

const { stacked=false } = Astro.props as IProps
---

<ul id="mediaList" class={`${(stacked)?'media-stack':'media-list'}`}>
  <slot />
</ul>

<style>
.media-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  list-style: none;
  margin: 0;
  padding: 0;
  gap: 1.25rem;
}

.media-stack {
  list-style: none;
  margin: 0;
  padding: 0;
  gap: 1.25rem;
}

/* Optional: lock to an exact track count at wider widths */
@media (min-width: 768px)   { .media-card-list { grid-template-columns: repeat(3, 1fr); } }
@media (min-width: 1280px)  { .media-card-list { grid-template-columns: repeat(4, 1fr); } }
</style>

<script is:inline type="module">
  const searchInput = document.getElementById('mediaSearch');
  const list = document.getElementById('mediaList');

  if (searchInput && list) {
    const filter = (value = '') => {
      const q = value.trim().toLowerCase();

      for (const item of list.children) {
        const haystack = (item.dataset.search ?? '').toLowerCase();
        item.hidden = q && !haystack.includes(q);
      }
    };

    // initial state (in case the field is autofilled)
    filter(searchInput.value);

    searchInput.addEventListener('input', e => filter(e.target.value));
  }
</script>